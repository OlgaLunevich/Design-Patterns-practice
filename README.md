# Design Patterns — Овал и Конус (Задание 3.8)

Проект выполнен в соответствии с требованиями дисциплины **Design Patterns**.  
Вариант: **3.8 — Овал и Конус**.

Цель работы — разработать приложение на TypeScript, реализующее объектную модель фигур **Овал** и **Конус**, с валидацией входных данных, вычислением геометрических параметров, фабриками (Factory Method), тестированием, логированием и архитектурным разделением слоёв.

---

## Структура проекта (Clean Architecture)

Проект организован по принципам «чистой архитектуры»:

```text
src/
  domain/                # Чистый домен (модели, интерфейсы, ошибки)
    entities/
      point.ts
      oval.ts
      cone.ts
    shapes/
      shape.ts
    errors/
      app-error.ts
      validation-error.ts
      file-error.ts

  application/           # Бизнес-логика, паттерны, use-cases
    factories/
      shape-factory.ts
      oval-factory.ts
      cone-factory.ts
    services/
      oval-geometry-service.ts
      cone-geometry-service.ts

  infrastructure/        # Работа с файлами, логирование
    file/
      shape-file-reader.ts
    logger/
      logger.ts

  shared/                # Утилиты, валидаторы, константы
    validation/
      validator.ts
      validation-result.ts
      oval-input-validator.ts
      cone-input-validator.ts
      geometry-result-validator.ts
    constants/
      math.ts
      regex.ts

  index.ts               # Точка входа
```


---

## Используемые паттерны

### **Factory Method**
Для создания фигур из входных строк применяется паттерн **Factory Method**:

- `OvalFactory`
- `ConeFactory`

Каждая фабрика:
- принимает строку из файла,
- валидирует параметры,
- создаёт объект-сущность или возвращает `null`.

### **Чистые сущности (Entities)**
Сущности **не содержат бизнес-логики**, только данные и геттеры:
- `Point`
- `Oval`
- `Cone`

Геометрия реализована в сервисах (`application/services`).

---

## Формат входных файлов

Данные читаются из `data/*.txt`.

### Для Овала:

x1 y1 x2 y2

Две точки — противоположные углы описанного прямоугольника.

### Формат Конуса:
x y z radius height


Некорректные строки:

- пропускаются,
- логируются,
- не останавливают выполнение программы.

---

## Валидация

### **1. Валидация входных данных**

Используются валидаторы:

- `OvalInputValidator`
- `ConeInputValidator`

Проверяется:

- количество значений,
- числовой формат,
- положительность радиуса и высоты,
- возможность построения фигуры.

### **2. Валидация результатов вычислений**

`GeometryResultValidator` проверяет:

- конечность (`isFinite`),
- неотрицательность результата.

Если вычисление некорректно → в лог пишется ошибка, метод возвращает `0`.

---

## Геометрические операции

### **Овал**

- площадь: `πab`
- периметр (приближение Рамануджана)
- является ли:
    - валидным овалом,
    - кругом (`|a - b| < ε`)
- пересекает ли только одну ось координат в пределах расстояния

### **Конус**

- объём: `(π r² h) / 3`
- площадь полной поверхности: `π r (r + √(r² + h²))`
- основание лежит на координатной плоскости (`z ≈ 0`)
- **рассечение плоскостью OXY (z = 0):**
    - расчёт объёмов верхней и нижней части по коэффициенту подобия `t³`

---

## Логирование (pino)

Используется библиотека **pino**, выводящая логи:

- в консоль (`stdout`)
- в файл `logs/app.log`

Логи фиксируют:

- ошибки валидации,
- пропуск некорректных строк,
- успешную загрузку фигур.

---

## Тестирование (Jest)

Проект покрыт unit-тестами:

- фабрики (включая негативные сценарии)
- валидаторы входных данных
- валидатор результатов вычислений
- геометрия овала
- геометрия конуса
- пересечение овала с осями
- рассечение конуса плоскостью OXY
- чтение данных из файлов

Команда запуска:

`npm test`

Каждый тест содержит более одного `expect`, согласно требованиям.

---

## Запуск проекта

Установка:

`npm install`


Сборка:

`npm run build`


Запуск:

`npm run dev`


---

## Требования задания — выполнены

- ✔ Использованы **ES6 модули** (`import` / `export`)
- ✔ Применён паттерн **Factory Method**
- ✔ Сущности **без бизнес-логики**
- ✔ Реализованы валидаторы входных данных
- ✔ Реализована валидация результатов вычислений
- ✔ Используются **кастомные ошибки**
- ✔ Присутствует **логирование** через `pino`
- ✔ Реализовано чтение данных из файлов с пропуском некорректных строк
- ✔ Покрытие **unit-тестами (Jest)**
- ✔ Соблюдены требования Style Guide (ESLint, TypeScript strict)
- ✔ Архитектура приведена к Clean Architecture

---

##  Автор: Ольга Луневич

Студент группы 23-HO 
Вариант: **3.8 — Овал и Конус**


